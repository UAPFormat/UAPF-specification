{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://uapf.dev/schemas/uapf-manifest.schema.json",
  "title": "UAPF Manifest (uapf.yaml) Schema",
  "type": "object",
  "additionalProperties": false,
  "required": ["id", "name", "level", "version", "kind"],
  "properties": {
    "kind": {
      "type": "string",
      "enum": ["uapf.package"]
    },
    "id": {
      "type": "string",
      "minLength": 3,
      "pattern": "^[a-z0-9][a-z0-9._-]+$"
    },
    "name": { "type": "string", "minLength": 1 },
    "description": { "type": "string" },
    "level": { "type": "integer", "minimum": 0, "maximum": 4 },
    "version": {
      "type": "string",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-[0-9A-Za-z.-]+)?(?:\\+[0-9A-Za-z.-]+)?$"
    },
    "includes": {
      "type": "array",
      "items": { "$ref": "#/$defs/packageRef" },
      "default": []
    },
    "cornerstones": {
      "type": "object",
      "additionalProperties": false,
      "required": ["bpmn", "dmn", "cmmn", "resources"],
      "properties": {
        "bpmn": { "type": "boolean" },
        "dmn": { "type": "boolean" },
        "cmmn": { "type": "boolean" },
        "resources": { "type": "boolean" }
      }
    },
    "paths": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "bpmn": { "type": "string", "default": "bpmn" },
        "dmn": { "type": "string", "default": "dmn" },
        "cmmn": { "type": "string", "default": "cmmn" },
        "resources": { "type": "string", "default": "resources" },
        "metadata": { "type": "string", "default": "metadata" }
      }
    },
    "owners": {
      "type": "array",
      "items": { "$ref": "#/$defs/owner" },
      "minItems": 1
    },
    "lifecycle": {
      "type": "string",
      "enum": ["draft", "review", "approved", "deprecated"]
    }
  },
  "$defs": {
    "packageRef": {
      "type": "string",
      "minLength": 1,
      "pattern": "^(\\.\\.?/|package:)[^\\s]+$"
    },
    "owner": {
      "type": "object",
      "additionalProperties": false,
      "required": ["type", "id"],
      "properties": {
        "type": { "type": "string", "enum": ["team", "person", "role"] },
        "id": { "type": "string", "minLength": 1 },
        "contact": { "type": "string" }
      }
    }
  }
}
